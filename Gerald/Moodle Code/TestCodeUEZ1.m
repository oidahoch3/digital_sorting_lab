%% Header
% LV Name
% LV Nummer
% Übungsblatt #

% Autor:
%   Vorname Nachname
%   Institut/Universität
%   E-Mail-Adresse

%% The mantra
clc
close all
clear all

pts = zeros(10,1);

%% Aufgabe 1
[file, path] = uigetfile(".xlsx");
addpath(path)
spectra = readmatrix(file);
pts(1,1) = test1(spectra);

%% Aufgabe 2
s1 = spectra(:,1);
s2 = spectra(:,2);
pts(2,1) = test2(s1, s2);    

%% Aufgabe 3
z1 = spectra(1,:);
z2 = spectra(2,:);
pts(3,1) = test3(z1, z2);    

%% Aufgabe 4
mean_spectra = round(mean(spectra,2));
pts(4,1) = test4(mean_spectra);

%% Aufgabe 5
median_spectra = round(median(spectra,2));
pts(5,1) = test5(median_spectra);

%% Aufgabe 6
res = spectra(:,1) .* spectra(:,2);
pts(6,1) = test6(res);

%% Aufgabe 7
p = plot(z1);
pts(7,1) = test7(p);

%% Aufgabe 8
dz1 = round(gradient(z1));
pts(8,1) = test8(dz1);

%% Aufgabe 9
p = plot(dz1);
pts(9,1) = test9(p);

%% Aufgabe 10
empt = spectra(mean(spectra,2)>4000);
pts(10,1) = test10(empt);


%%
disp("Gesamtpunkte = "+num2str(sum(pts,1)));

%% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %% %%
% Ab hier nichts ändern
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    
%% Tests
function pts = test1(spectra)
    if spectra(1,:) ==  [1155	1151	1146	1143	1141	1140	1137	1135	1133	1133	1136	1139	1141	1142	1142	1140	1139	1138	1139	1141	1142	1142	1141	1139	1138	1139	1140	1142	1144	1145	1146	1146	1146	1145	1145	1146	1147	1147	1144	1139	1134	1130	1124	1117	1106	1093	1075	1054	1030	1005	983	965	950	936	921	904	884	862	839	815	791	768	749	735	729	727	729	730	730	730	731	736	747	763	784	808	832	855	875	893	909	923	935	946	957	966	974	982	988	993	997	999	1002	1004	1006	1008	1009	1010	1011	1012	1012	1013	1015	1016	1016	1015	1013	1012	1010	1007	1004	1000	993	982	963	936	904	869	836	808	786	767	750	733	717	703	691	680	672	669	672	677	684	690	693	696	699	704	709	714	717	721	724	727	732	737	743	750	757	764	770	776	781	787	793	799	804	807	809	811	814	820	828	837	845	853	859	864	869	874	880	885	891	896	901	904	907	908	909	909	910	910	909	908	905	903	900	898	895	891	887	883	879	876	872	868	863	858	853	848	842	835	827	817	805	793	782	773	768	764	762	761	761	761	760	758	755	751	746	743]
        disp("A1: Korrekt importiert")
        pts = 1;
    else
        disp("A1: Excel wurde nicht korrekt importiert")
        pts = 0;
    end
end

function pts = test2(s1, s2)
    if s1 == [1155;1052;1118] & s2 == [1151;1049;1117]
        disp("A2: Korrekt!")
        pts = 1;
    else
        disp("A2: Variablen wurde nicht korrekt erstellt")
        pts = 0;
    end
end

function pts = test3(z1, z2)
    if z1 == [1155	1151	1146	1143	1141	1140	1137	1135	1133	1133	1136	1139	1141	1142	1142	1140	1139	1138	1139	1141	1142	1142	1141	1139	1138	1139	1140	1142	1144	1145	1146	1146	1146	1145	1145	1146	1147	1147	1144	1139	1134	1130	1124	1117	1106	1093	1075	1054	1030	1005	983	965	950	936	921	904	884	862	839	815	791	768	749	735	729	727	729	730	730	730	731	736	747	763	784	808	832	855	875	893	909	923	935	946	957	966	974	982	988	993	997	999	1002	1004	1006	1008	1009	1010	1011	1012	1012	1013	1015	1016	1016	1015	1013	1012	1010	1007	1004	1000	993	982	963	936	904	869	836	808	786	767	750	733	717	703	691	680	672	669	672	677	684	690	693	696	699	704	709	714	717	721	724	727	732	737	743	750	757	764	770	776	781	787	793	799	804	807	809	811	814	820	828	837	845	853	859	864	869	874	880	885	891	896	901	904	907	908	909	909	910	910	909	908	905	903	900	898	895	891	887	883	879	876	872	868	863	858	853	848	842	835	827	817	805	793	782	773	768	764	762	761	761	761	760	758	755	751	746	743] & z2 == [1052	1049	1046	1043	1041	1038	1032	1028	1028	1032	1037	1038	1035	1032	1031	1030	1030	1031	1033	1035	1035	1036	1036	1037	1037	1036	1036	1037	1039	1040	1040	1039	1039	1039	1038	1038	1037	1038	1037	1035	1031	1026	1020	1014	1005	992	975	953	929	904	883	865	850	834	817	799	779	758	734	708	680	654	633	620	615	615	618	621	622	621	622	627	639	657	679	703	728	751	773	792	809	823	835	846	857	866	875	882	889	894	897	900	903	906	908	910	912	912	913	913	914	914	914	914	914	914	913	912	911	909	906	902	895	883	864	837	804	768	734	706	682	663	644	626	610	595	582	571	562	557	558	565	573	581	586	590	594	599	604	608	612	615	619	623	628	634	641	649	657	663	668	673	678	685	691	697	703	706	710	713	716	722	729	737	746	755	763	770	775	779	784	790	797	803	808	811	813	813	814	814	814	814	813	812	811	809	806	804	800	796	791	787	784	781	777	773	768	762	756	749	743	736	726	715	703	691	681	673	667	663	661	660	661	661	659	656	652	647	641	637]
        disp("A3: Korrekt!")
        pts = 1;
    else
        disp("A3: Variablen wurde nicht korrekt erstellt")
        pts = 0;
    end
end

function pts = test4(mean_spectra)
    if round(mean_spectra) == [910;  808;  866]
        disp("A4: Korrekt!")
        pts = 1;
    else
        disp("A4: Mittelwerte wurde nicht korrekt erstellt")
        pts = 0;
    end
end

function pts = test5(median_spectra)
    if round(median_spectra) == [892;  797;  848]
        disp("A5: Korrekt!")
        pts = 1;
    else
        disp("A5: Mittelwerte wurde nicht korrekt erstellt")
        pts = 0;
    end
end

function pts = test6(res)
    if round(res) == [1329405;  1103548;  1248806]
        disp("A6: Korrekt!")
        pts = 1;
    else
        disp("A6: Multiplikation wurde nicht korrekt erstellt")
        pts = 0;
    end
end

function pts = test7(p)
    if p.YData == [1155	1151	1146	1143	1141	1140	1137	1135	1133	1133	1136	1139	1141	1142	1142	1140	1139	1138	1139	1141	1142	1142	1141	1139	1138	1139	1140	1142	1144	1145	1146	1146	1146	1145	1145	1146	1147	1147	1144	1139	1134	1130	1124	1117	1106	1093	1075	1054	1030	1005	983	965	950	936	921	904	884	862	839	815	791	768	749	735	729	727	729	730	730	730	731	736	747	763	784	808	832	855	875	893	909	923	935	946	957	966	974	982	988	993	997	999	1002	1004	1006	1008	1009	1010	1011	1012	1012	1013	1015	1016	1016	1015	1013	1012	1010	1007	1004	1000	993	982	963	936	904	869	836	808	786	767	750	733	717	703	691	680	672	669	672	677	684	690	693	696	699	704	709	714	717	721	724	727	732	737	743	750	757	764	770	776	781	787	793	799	804	807	809	811	814	820	828	837	845	853	859	864	869	874	880	885	891	896	901	904	907	908	909	909	910	910	909	908	905	903	900	898	895	891	887	883	879	876	872	868	863	858	853	848	842	835	827	817	805	793	782	773	768	764	762	761	761	761	760	758	755	751	746	743]
        disp("A7: Plot ist korrekt")
        pts = 1;
    else
        disp("A7: Plot ist inkorrekt")
        pts = 0;
    end
end

function pts = test8(dz1)
    if dz1 == [-4	-5	-4	-3	-2	-2	-3	-2	-1	2	3	3	2	1	-1	-2	-1	0	2	2	1	-1	-2	-2	0	1	2	2	2	1	1	0	-1	-1	1	1	1	-2	-4	-5	-5	-5	-7	-9	-12	-16	-20	-23	-25	-24	-20	-17	-15	-15	-16	-19	-21	-23	-24	-24	-24	-21	-17	-10	-4	0	2	1	0	1	3	8	14	19	23	24	24	22	19	17	15	13	12	11	10	9	8	7	6	5	3	3	3	2	2	2	1	1	1	1	1	2	2	1	-1	-2	-2	-2	-3	-3	-4	-6	-9	-15	-23	-30	-34	-34	-31	-25	-21	-18	-17	-17	-15	-13	-12	-10	-6	0	4	6	7	5	3	3	4	5	5	4	4	4	3	4	5	6	7	7	7	7	6	6	6	6	6	6	4	3	2	3	5	7	9	9	8	7	6	5	5	6	6	6	6	5	4	3	2	1	1	1	1	-1	-1	-2	-3	-3	-3	-3	-4	-4	-4	-4	-4	-4	-4	-5	-5	-5	-5	-6	-7	-8	-9	-11	-12	-12	-10	-7	-5	-3	-2	-1	0	-1	-2	-3	-4	-5	-4	-3]
        disp("A8: Ableitung ist korrekt")
        pts = 1;
    else
        disp("A8: Ableitung ist inkorrekt")
        pts = 0;
    end
end

function pts = test9(p)
    if p.YData == [-4	-5	-4	-3	-2	-2	-3	-2	-1	2	3	3	2	1	-1	-2	-1	0	2	2	1	-1	-2	-2	0	1	2	2	2	1	1	0	-1	-1	1	1	1	-2	-4	-5	-5	-5	-7	-9	-12	-16	-20	-23	-25	-24	-20	-17	-15	-15	-16	-19	-21	-23	-24	-24	-24	-21	-17	-10	-4	0	2	1	0	1	3	8	14	19	23	24	24	22	19	17	15	13	12	11	10	9	8	7	6	5	3	3	3	2	2	2	1	1	1	1	1	2	2	1	-1	-2	-2	-2	-3	-3	-4	-6	-9	-15	-23	-30	-34	-34	-31	-25	-21	-18	-17	-17	-15	-13	-12	-10	-6	0	4	6	7	5	3	3	4	5	5	4	4	4	3	4	5	6	7	7	7	7	6	6	6	6	6	6	4	3	2	3	5	7	9	9	8	7	6	5	5	6	6	6	6	5	4	3	2	1	1	1	1	-1	-1	-2	-3	-3	-3	-3	-4	-4	-4	-4	-4	-4	-4	-5	-5	-5	-5	-6	-7	-8	-9	-11	-12	-12	-10	-7	-5	-3	-2	-1	0	-1	-2	-3	-4	-5	-4	-3]
        disp("A9: Plot ist korrekt")
        pts = 1;
    else
        disp("A9: Plot ist inkorrekt")
        pts = 0;
    end
end

function pts = test10(empt)
    if size(empt,1) == 0
        disp("A10: Array ist korrekt")
        pts = 1;
    else
        disp("A10: Array ist inkorrekt")
        pts = 0;
    end
end
